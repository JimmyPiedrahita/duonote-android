<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/harmoninote/NoteWidget.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/harmoninote/NoteWidget.kt" />
              <option name="originalContent" value="package com.example.harmoninote&#10;&#10;import android.app.PendingIntent&#10;import android.appwidget.AppWidgetManager&#10;import android.appwidget.AppWidgetProvider&#10;import android.content.ComponentName&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.widget.RemoteViews&#10;import kotlin.jvm.java&#10;import androidx.core.net.toUri&#10;&#10;@Suppress(&quot;DEPRECATION&quot;)&#10;class NoteWidget : AppWidgetProvider() {&#10;    override fun onUpdate(&#10;        context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray&#10;    ) {&#10;        for (widgetId in appWidgetIds) {&#10;            val intent = Intent(context, NoteWidgetService::class.java).apply {&#10;                putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, widgetId)&#10;                data = this.toUri(Intent.URI_INTENT_SCHEME).toUri()&#10;            }&#10;            val views = RemoteViews(context.packageName, R.layout.widget_layout).apply {&#10;                setRemoteAdapter(R.id.widget_list_view, intent)&#10;                setEmptyView(R.id.widget_list_view, android.R.id.empty)&#10;            }&#10;            val dialogIntent = Intent(context, DialogActivity::class.java).apply {&#10;                flags = Intent.FLAG_ACTIVITY_NEW_TASK&#10;            }&#10;            val pendingIntent = PendingIntent.getActivity(&#10;                context,&#10;                0,&#10;                dialogIntent,&#10;                PendingIntent.FLAG_IMMUTABLE&#10;            )&#10;            views.setOnClickPendingIntent(R.id.imageButton, pendingIntent)&#10;            val clickIntent = Intent(context, NoteActionReceiver::class.java)&#10;            val pendingIntentTemplate = PendingIntent.getBroadcast(&#10;                context,&#10;                0,&#10;                clickIntent,&#10;                PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE&#10;            )&#10;            views.setPendingIntentTemplate(R.id.widget_list_view, pendingIntentTemplate)&#10;            appWidgetManager.updateAppWidget(widgetId, views)&#10;        }&#10;    }&#10;    override fun onReceive(context: Context?, intent: Intent?) {&#10;        super.onReceive(context, intent)&#10;        if (intent?.action == AppWidgetManager.ACTION_APPWIDGET_UPDATE &amp;&amp; context != null) {&#10;            val appWidgetManager = AppWidgetManager.getInstance(context)&#10;            val ids = appWidgetManager.getAppWidgetIds(ComponentName(context, NoteWidget::class.java))&#10;            appWidgetManager.notifyAppWidgetViewDataChanged(ids, R.id.widget_list_view)&#10;        }&#10;    }&#10;    companion object {&#10;        fun updateWidget(context: Context) {&#10;            val intent = Intent(context, NoteWidget::class.java).apply {&#10;                action = AppWidgetManager.ACTION_APPWIDGET_UPDATE&#10;            }&#10;            val appWidgetManager = AppWidgetManager.getInstance(context)&#10;            val ids = appWidgetManager.getAppWidgetIds(ComponentName(context, NoteWidget::class.java))&#10;            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, ids)&#10;            context.sendBroadcast(intent)&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.harmoninote&#10;&#10;import android.app.PendingIntent&#10;import android.appwidget.AppWidgetManager&#10;import android.appwidget.AppWidgetProvider&#10;import android.content.ComponentName&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.os.Build&#10;import android.widget.RemoteViews&#10;import kotlin.jvm.java&#10;import androidx.core.net.toUri&#10;&#10;@Suppress(&quot;DEPRECATION&quot;)&#10;class NoteWidget : AppWidgetProvider() {&#10;    override fun onUpdate(&#10;        context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray&#10;    ) {&#10;        for (widgetId in appWidgetIds) {&#10;            val intent = Intent(context, NoteWidgetService::class.java).apply {&#10;                putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, widgetId)&#10;                data = this.toUri(Intent.URI_INTENT_SCHEME).toUri()&#10;            }&#10;            val views = RemoteViews(context.packageName, R.layout.widget_layout).apply {&#10;                setRemoteAdapter(R.id.widget_list_view, intent)&#10;                setEmptyView(R.id.widget_list_view, android.R.id.empty)&#10;            }&#10;            val dialogIntent = Intent(context, DialogActivity::class.java).apply {&#10;                flags = Intent.FLAG_ACTIVITY_NEW_TASK&#10;            }&#10;            &#10;            // Compatibilidad con versiones Android 12+ y anteriores&#10;            val pendingIntentFlags = if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.S) {&#10;                PendingIntent.FLAG_IMMUTABLE&#10;            } else {&#10;                0&#10;            }&#10;            &#10;            val pendingIntent = PendingIntent.getActivity(&#10;                context,&#10;                0,&#10;                dialogIntent,&#10;                pendingIntentFlags&#10;            )&#10;            views.setOnClickPendingIntent(R.id.imageButton, pendingIntent)&#10;            val clickIntent = Intent(context, NoteActionReceiver::class.java)&#10;            &#10;            val broadcastFlags = if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.S) {&#10;                PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE&#10;            } else {&#10;                PendingIntent.FLAG_UPDATE_CURRENT&#10;            }&#10;            &#10;            val pendingIntentTemplate = PendingIntent.getBroadcast(&#10;                context,&#10;                0,&#10;                clickIntent,&#10;                broadcastFlags&#10;            )&#10;            views.setPendingIntentTemplate(R.id.widget_list_view, pendingIntentTemplate)&#10;            appWidgetManager.updateAppWidget(widgetId, views)&#10;        }&#10;    }&#10;    override fun onReceive(context: Context?, intent: Intent?) {&#10;        super.onReceive(context, intent)&#10;        if (intent?.action == AppWidgetManager.ACTION_APPWIDGET_UPDATE &amp;&amp; context != null) {&#10;            val appWidgetManager = AppWidgetManager.getInstance(context)&#10;            val ids = appWidgetManager.getAppWidgetIds(ComponentName(context, NoteWidget::class.java))&#10;            appWidgetManager.notifyAppWidgetViewDataChanged(ids, R.id.widget_list_view)&#10;        }&#10;    }&#10;    companion object {&#10;        fun updateWidget(context: Context) {&#10;            val intent = Intent(context, NoteWidget::class.java).apply {&#10;                action = AppWidgetManager.ACTION_APPWIDGET_UPDATE&#10;            }&#10;            val appWidgetManager = AppWidgetManager.getInstance(context)&#10;            val ids = appWidgetManager.getAppWidgetIds(ComponentName(context, NoteWidget::class.java))&#10;            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, ids)&#10;            context.sendBroadcast(intent)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>